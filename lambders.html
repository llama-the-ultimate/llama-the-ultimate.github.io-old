<!DOCTYPE HTML>
<html><head><meta charset="UTF-8"><title>stuff</title><script type="text/javascript" src="elm-runtime.js"></script><script type="text/javascript">Elm.Main = Elm.Main || {};
Elm.Main.make = function (_elm) {
   "use strict";
   _elm.Main = _elm.Main || {};
   if (_elm.Main.values)
   return _elm.Main.values;
   var _N = Elm.Native,
   _U = _N.Utils.make(_elm),
   _L = _N.List.make(_elm),
   _E = _N.Error.make(_elm),
   _J = _N.JavaScript.make(_elm),
   $moduleName = "Main";
   var Basics = Elm.Basics.make(_elm);
   var Color = Elm.Color.make(_elm);
   var Eval = Elm.Eval.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Collage = Elm.Graphics.Collage.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Element = Elm.Graphics.Element.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Input = Elm.Graphics.Input.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Input = Graphics.Input || {};
   Graphics.Input.Field = Elm.Graphics.Input.Field.make(_elm);
   var Keyboard = Elm.Keyboard.make(_elm);
   var List = Elm.List.make(_elm);
   var Maybe = Elm.Maybe.make(_elm);
   var Native = Native || {};
   Native.Ports = Elm.Native.Ports.make(_elm);
   var Signal = Elm.Signal.make(_elm);
   var String = Elm.String.make(_elm);
   var Surface = Elm.Surface.make(_elm);
   var Term = Elm.Term.make(_elm);
   var Text = Elm.Text.make(_elm);
   var Time = Elm.Time.make(_elm);
   var _op = {};
   var link = Signal.constant(
   Text.markdown("<div style=\"height:0;width:0;\">&nbsp;</div><p><a href=\"https://github.com/Glorp/Elmbdas\">ploink</a></p><div style=\"height:0;width:0;\">&nbsp;</div>",
   "61:26"));
   var defTerm = function (t) {
      return function () {
         switch (t.ctor)
         {case "Define": return true;
            case "Undefine": return true;}
         return false;
      }();
   };
   var addRemoveDef = F2(function (trm,
   lst) {
      return function () {
         var remove = F2(function (s,
         l) {
            return function () {
               switch (l.ctor)
               {case "::": switch (l._0.ctor)
                    {case "Define": return _U.eq(s,
                         l._0._0) ? l._1 : {ctor: "::"
                                           ,_0: A2(Term.Define,
                                           l._0._0,
                                           l._0._1)
                                           ,_1: A2(remove,s,l._1)};}
                    break;
                  case "[]":
                  return _J.toList([]);}
               _E.Case($moduleName,
               "between lines 30 and 35");
            }();
         });
         var add = F3(function (s,t,l) {
            return function () {
               switch (l.ctor)
               {case "::": switch (l._0.ctor)
                    {case "Define": return _U.eq(s,
                         l._0._0) ? {ctor: "::"
                                    ,_0: A2(Term.Define,s,t)
                                    ,_1: l._1} : {ctor: "::"
                                                 ,_0: A2(Term.Define,
                                                 l._0._0,
                                                 l._0._1)
                                                 ,_1: A3(add,s,t,l._1)};}
                    break;
                  case "[]":
                  return _J.toList([A2(Term.Define,
                    s,
                    t)]);}
               _E.Case($moduleName,
               "between lines 25 and 29");
            }();
         });
         return function () {
            switch (trm.ctor)
            {case "Just":
               switch (trm._0.ctor)
                 {case "Define": return A3(add,
                      trm._0._0,
                      trm._0._1,
                      lst);
                    case "Undefine":
                    return A2(remove,
                      trm._0._0,
                      lst);}
                 break;}
            return lst;
         }();
      }();
   });
   var makeField = F2(function (s,
   ss) {
      return function () {
         var content = Graphics.Input.input(A2(Graphics.Input.Field.Content,
         ss,
         A3(Graphics.Input.Field.Selection,
         0,
         0,
         Graphics.Input.Field.Forward)));
         var fi = A2(Signal.lift,
         A4(Graphics.Input.Field.field,
         Graphics.Input.Field.defaultStyle,
         content.handle,
         Basics.id,
         s),
         content.signal);
         return {ctor: "_Tuple2"
                ,_0: fi
                ,_1: content.signal};
      }();
   });
   var $ = A2(makeField,
   "λ",
   "(λa.λb.a (λn.λf.λx.f (n f x)) b) (λf.λx.f (f x)) (λf.λx.f (f x))"),
   field = $._0,
   content = $._1;
   var termsig = A2(Signal.lift,
   function ($) {
      return Surface.readTerm(function (_) {
         return _.string;
      }($));
   },
   content);
   var reduceN = F2(function (n,
   mt) {
      return function () {
         switch (mt.ctor)
         {case "Just": return _U.eq(n,
              0) ? _J.toList([mt._0]) : {ctor: "::"
                                        ,_0: mt._0
                                        ,_1: A2(reduceN,
                                        n - 1,
                                        Eval.reduceRename(mt._0))};
            case "Nothing":
            return _J.toList([]);}
         _E.Case($moduleName,
         "between lines 13 and 16");
      }();
   });
   var tstr = F2(function (x,
   defs) {
      return function () {
         switch (x.ctor)
         {case "Just":
            return defTerm(x._0) ? _J.toList([Surface.termstr(x._0)]) : A2(List.map,
              Surface.termstr,
              A2(reduceN,
              50,
              Maybe.Just(A2(Eval.renameDefs,
              x._0,
              defs))));
            case "Nothing":
            return _J.toList([":("]);}
         _E.Case($moduleName,
         "between lines 52 and 55");
      }();
   });
   var mtermstr = function (x) {
      return function () {
         switch (x.ctor)
         {case "Just":
            return A2(List.map,
              Surface.termstr,
              A2(reduceN,
              100,
              Maybe.Just(x._0)));
            case "Nothing":
            return _J.toList([":("]);}
         _E.Case($moduleName,
         "between lines 57 and 59");
      }();
   };
   var entered = A3(Signal.keepIf,
   Basics.id,
   false,
   Keyboard.enter);
   var defsig = A3(Signal.foldp,
   addRemoveDef,
   _J.toList([]),
   A2(Signal.sampleOn,
   entered,
   termsig));
   var defs = A2(Signal.lift,
   Graphics.Element.flow(Graphics.Element.down),
   A2(Signal.lift,
   List.map(function ($) {
      return Text.plainText(Surface.termstr($));
   }),
   defsig));
   var main = function () {
      var a = A2(Signal.lift,
      Graphics.Element.flow(Graphics.Element.down),
      A3(Signal.lift2,
      F2(function (x,y) {
         return A2(List.map,
         Text.plainText,
         A2(tstr,x,y));
      }),
      termsig,
      defsig));
      var x = A2(Signal.lift,
      Graphics.Element.flow(Graphics.Element.down),
      A2(Signal.lift,
      function (x) {
         return A2(List.map,
         Text.plainText,
         mtermstr(x));
      },
      termsig));
      var f = A2(Signal.lift,
      Graphics.Element.width(1000),
      field);
      return A2(Signal.lift,
      Graphics.Element.flow(Graphics.Element.down),
      Signal.combine(_J.toList([link
                               ,defs
                               ,f
                               ,a])));
   }();
   _elm.Main.values = {_op: _op
                      ,entered: entered
                      ,reduceN: reduceN
                      ,makeField: makeField
                      ,content: content
                      ,field: field
                      ,addRemoveDef: addRemoveDef
                      ,termsig: termsig
                      ,defsig: defsig
                      ,defs: defs
                      ,defTerm: defTerm
                      ,tstr: tstr
                      ,mtermstr: mtermstr
                      ,link: link
                      ,main: main};
   return _elm.Main.values;
};Elm.Eval = Elm.Eval || {};
Elm.Eval.make = function (_elm) {
   "use strict";
   _elm.Eval = _elm.Eval || {};
   if (_elm.Eval.values)
   return _elm.Eval.values;
   var _N = Elm.Native,
   _U = _N.Utils.make(_elm),
   _L = _N.List.make(_elm),
   _E = _N.Error.make(_elm),
   _J = _N.JavaScript.make(_elm),
   $moduleName = "Eval";
   var Basics = Elm.Basics.make(_elm);
   var Color = Elm.Color.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Collage = Elm.Graphics.Collage.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Element = Elm.Graphics.Element.make(_elm);
   var List = Elm.List.make(_elm);
   var Maybe = Elm.Maybe.make(_elm);
   var Native = Native || {};
   Native.Ports = Elm.Native.Ports.make(_elm);
   var Set = Elm.Set.make(_elm);
   var Signal = Elm.Signal.make(_elm);
   var String = Elm.String.make(_elm);
   var Term = Elm.Term.make(_elm);
   var Text = Elm.Text.make(_elm);
   var Time = Elm.Time.make(_elm);
   var _op = {};
   var allIds = function (t) {
      return function () {
         switch (t.ctor)
         {case "App":
            return A2(Set.union,
              allIds(t._0),
              allIds(t._1));
            case "Lam": return A2(Set.union,
              Set.singleton(t._0),
              allIds(t._1));
            case "Var":
            return Set.singleton(t._0);}
         _E.Case($moduleName,
         "between lines 84 and 87");
      }();
   };
   var uniqueId = F2(function (t,
   s) {
      return function () {
         var ids = allIds(t);
         var uniq = function (n) {
            return function () {
               var newId = List.concat(_J.toList([s
                                                 ,String.show(n)]));
               return A2(Set.member,
               newId,
               ids) ? uniq(n + 1) : newId;
            }();
         };
         return uniq(2);
      }();
   });
   var freeIds = F2(function (t,
   env) {
      return function () {
         switch (t.ctor)
         {case "App":
            return A2(Set.union,
              A2(freeIds,t._0,env),
              A2(freeIds,t._1,env));
            case "Lam": return A2(freeIds,
              t._1,
              A2(Set.insert,t._0,env));
            case "Var":
            return A2(Set.member,
              t._0,
              env) ? Set.empty : Set.singleton(t._0);}
         _E.Case($moduleName,
         "between lines 66 and 70");
      }();
   });
   var subst = F3(function (t,
   s,
   x) {
      return function () {
         switch (x.ctor)
         {case "App": return A2(Term.App,
              A3(subst,t,s,x._0),
              A3(subst,t,s,x._1));
            case "Lam": return _U.eq(x._0,
              s) ? A2(Term.Lam,
              x._0,
              x._1) : A2(Term.Lam,
              x._0,
              A3(subst,t,s,x._1));
            case "Var": return _U.eq(x._0,
              s) ? t : Term.Var(x._0);}
         _E.Case($moduleName,
         "between lines 59 and 64");
      }();
   });
   var rename = F2(function (t,
   _v18) {
      return function () {
         switch (_v18.ctor)
         {case "Lam":
            return function () {
                 var s = A2(uniqueId,
                 t,
                 _v18._0);
                 return A2(Term.Lam,
                 s,
                 A3(subst,
                 Term.Var(s),
                 _v18._0,
                 _v18._1));
              }();}
         _E.Case($moduleName,
         "between lines 81 and 82");
      }();
   });
   var renameDef = F2(function (_v22,
   trm) {
      return function () {
         switch (_v22.ctor)
         {case "Define":
            return function () {
                 var renameD = function (t) {
                    return function () {
                       switch (t.ctor)
                       {case "App": return A2(Term.App,
                            renameD(t._0),
                            renameD(t._1));
                          case "Lam": return _U.eq(t._0,
                            _v22._0) ? A2(Term.Lam,
                            t._0,
                            t._1) : A2(Term.Lam,
                            t._0,
                            renameD(t._1));
                          case "Var": return _U.eq(t._0,
                            _v22._0) ? _v22._1 : Term.Var(t._0);}
                       _E.Case($moduleName,
                       "between lines 51 and 57");
                    }();
                 };
                 return renameD(trm);
              }();}
         _E.Case($moduleName,
         "between lines 51 and 57");
      }();
   });
   var renameDefs = F2(function (trm,
   defs) {
      return A3(List.foldr,
      renameDef,
      trm,
      defs);
   });
   var reducible = function (t) {
      return function () {
         switch (t.ctor)
         {case "App": switch (t._0.ctor)
              {case "Lam": return true;}
              break;}
         return false;
      }();
   };
   var D = {ctor: "D"};
   var A = {ctor: "A"};
   var F = {ctor: "F"};
   var L = {ctor: "L"};
   var findPath0 = F3(function (pred,
   t,
   res) {
      return function () {
         var _v37 = pred(t);
         switch (_v37)
         {case false:
            return function () {
                 switch (t.ctor)
                 {case "App":
                    return A4(findPathApp,
                      pred,
                      t._0,
                      t._1,
                      res);
                    case "Lam": return A3(findPath0,
                      pred,
                      t._1,
                      {ctor: "::",_0: L,_1: res});}
                 return Maybe.Nothing;
              }();
            case true:
            return Maybe.Just(res);}
         _E.Case($moduleName,
         "between lines 17 and 22");
      }();
   });
   var findPathApp = F4(function (pred,
   f,
   a,
   res) {
      return function () {
         var _v43 = A3(findPath0,
         pred,
         f,
         {ctor: "::",_0: F,_1: res});
         switch (_v43.ctor)
         {case "Just":
            return Maybe.Just(_v43._0);
            case "Nothing":
            return A3(findPath0,
              pred,
              a,
              {ctor: "::",_0: A,_1: res});}
         _E.Case($moduleName,
         "between lines 13 and 15");
      }();
   });
   var findPath = F2(function (pred,
   t) {
      return function () {
         var _v45 = A3(findPath0,
         pred,
         t,
         _J.toList([]));
         switch (_v45.ctor)
         {case "Just":
            return Maybe.Just(List.reverse(_v45._0));
            case "Nothing":
            return Maybe.Nothing;}
         _E.Case($moduleName,
         "between lines 9 and 11");
      }();
   });
   var pathStep = F2(function (t,
   b) {
      return function () {
         var _v47 = {ctor: "_Tuple2"
                    ,_0: t
                    ,_1: b};
         switch (_v47.ctor)
         {case "_Tuple2":
            switch (_v47._0.ctor)
              {case "App":
                 switch (_v47._1.ctor)
                   {case "A": return _v47._0._1;
                      case "F": return _v47._0._0;}
                   break;
                 case "Lam":
                 switch (_v47._1.ctor)
                   {case "L": return _v47._0._1;}
                   break;}
              break;}
         _E.Case($moduleName,
         "between lines 24 and 27");
      }();
   });
   var followPath = F2(function (t,
   p) {
      return function () {
         switch (p.ctor)
         {case "::":
            return A2(followPath,
              A2(pathStep,t,p._0),
              p._1);
            case "[]": return t;}
         _E.Case($moduleName,
         "between lines 29 and 31");
      }();
   });
   var pathFirst = F4(function (t,
   p,
   pred,
   current) {
      return function () {
         switch (p.ctor)
         {case "::":
            return pred(t) ? Maybe.Just(List.reverse(current)) : A4(pathFirst,
              A2(pathStep,t,p._0),
              p._1,
              pred,
              {ctor: "::"
              ,_0: p._0
              ,_1: current});
            case "[]":
            return Maybe.Nothing;}
         _E.Case($moduleName,
         "between lines 39 and 42");
      }();
   });
   var findScope = F3(function (t,
   p,
   ids) {
      return A4(pathFirst,
      t,
      p,
      function (x) {
         return function () {
            switch (x.ctor)
            {case "Lam":
               return A2(Set.member,
                 x._0,
                 ids) ? true : false;}
            return false;
         }();
      },
      _J.toList([]));
   });
   var followPathThen = F3(function (t,
   p,
   fn) {
      return function () {
         var _v63 = {ctor: "_Tuple2"
                    ,_0: t
                    ,_1: p};
         switch (_v63.ctor)
         {case "_Tuple2":
            switch (_v63._1.ctor)
              {case "[]": return fn(_v63._0);}
              switch (_v63._0.ctor)
              {case "App":
                 switch (_v63._1.ctor)
                   {case "::":
                      switch (_v63._1._0.ctor)
                        {case "A": return A2(Term.App,
                             _v63._0._0,
                             A3(followPathThen,
                             _v63._0._1,
                             _v63._1._1,
                             fn));
                           case "F": return A2(Term.App,
                             A3(followPathThen,
                             _v63._0._0,
                             _v63._1._1,
                             fn),
                             _v63._0._1);}
                        break;}
                   break;
                 case "Lam":
                 switch (_v63._1.ctor)
                   {case "::":
                      switch (_v63._1._0.ctor)
                        {case "L": return A2(Term.Lam,
                             _v63._0._0,
                             A3(followPathThen,
                             _v63._0._1,
                             _v63._1._1,
                             fn));}
                        break;}
                   break;}
              break;}
         _E.Case($moduleName,
         "between lines 33 and 37");
      }();
   });
   var conflict = F2(function (_v74,
   arg) {
      return function () {
         switch (_v74.ctor)
         {case "Lam":
            return function () {
                 var ids = A2(freeIds,
                 arg,
                 Set.empty);
                 var conf = F3(function (t,
                 poss,
                 res) {
                    return function () {
                       switch (t.ctor)
                       {case "App":
                          return function () {
                               var _v84 = A3(conf,
                               t._0,
                               poss,
                               {ctor: "::",_0: F,_1: res});
                               switch (_v84.ctor)
                               {case "Just":
                                  return Maybe.Just(_v84._0);
                                  case "Nothing": return A3(conf,
                                    t._1,
                                    poss,
                                    {ctor: "::",_0: A,_1: res});}
                               _E.Case($moduleName,
                               "between lines 109 and 111");
                            }();
                          case "Lam": return _U.eq(t._0,
                            _v74._0) ? Maybe.Nothing : A3(conf,
                            t._1,
                            poss || A2(Set.member,t._0,ids),
                            {ctor: "::",_0: L,_1: res});
                          case "Var": return _U.eq(t._0,
                            _v74._0) && poss ? Maybe.Just(List.reverse(res)) : Maybe.Nothing;}
                       _E.Case($moduleName,
                       "between lines 106 and 114");
                    }();
                 });
                 return A3(conf,
                 _v74._1,
                 false,
                 _J.toList([]));
              }();}
         _E.Case($moduleName,
         "between lines 105 and 114");
      }();
   });
   var reduceRename0 = F2(function (t,
   _v86) {
      return function () {
         switch (_v86.ctor)
         {case "App":
            switch (_v86._0.ctor)
              {case "Lam":
                 return function () {
                      var _v92 = A2(conflict,
                      A2(Term.Lam,
                      _v86._0._0,
                      _v86._0._1),
                      _v86._1);
                      switch (_v92.ctor)
                      {case "Just":
                         return function () {
                              var _v94 = A3(findScope,
                              _v86._0._1,
                              _v92._0,
                              A2(freeIds,_v86._1,Set.empty));
                              switch (_v94.ctor)
                              {case "Just":
                                 return A2(Term.App,
                                   A2(Term.Lam,
                                   _v86._0._0,
                                   A3(followPathThen,
                                   _v86._0._1,
                                   _v94._0,
                                   rename(t))),
                                   _v86._1);}
                              _E.Case($moduleName,
                              "between lines 79 and 80");
                           }();
                         case "Nothing": return A3(subst,
                           _v86._1,
                           _v86._0._0,
                           _v86._0._1);}
                      _E.Case($moduleName,
                      "between lines 77 and 80");
                   }();}
              break;}
         _E.Case($moduleName,
         "between lines 77 and 80");
      }();
   });
   var reduceRename = function (t) {
      return function () {
         var _v96 = A2(findPath,
         reducible,
         t);
         switch (_v96.ctor)
         {case "Just":
            return Maybe.Just(A3(followPathThen,
              t,
              _v96._0,
              reduceRename0(t)));
            case "Nothing":
            return Maybe.Nothing;}
         _E.Case($moduleName,
         "between lines 72 and 75");
      }();
   };
   _elm.Eval.values = {_op: _op
                      ,findPath: findPath
                      ,findPathApp: findPathApp
                      ,findPath0: findPath0
                      ,pathStep: pathStep
                      ,followPath: followPath
                      ,followPathThen: followPathThen
                      ,pathFirst: pathFirst
                      ,reducible: reducible
                      ,renameDefs: renameDefs
                      ,renameDef: renameDef
                      ,subst: subst
                      ,freeIds: freeIds
                      ,reduceRename: reduceRename
                      ,reduceRename0: reduceRename0
                      ,rename: rename
                      ,allIds: allIds
                      ,uniqueId: uniqueId
                      ,findScope: findScope
                      ,conflict: conflict
                      ,L: L
                      ,F: F
                      ,A: A
                      ,D: D};
   return _elm.Eval.values;
};Elm.Surface = Elm.Surface || {};
Elm.Surface.make = function (_elm) {
   "use strict";
   _elm.Surface = _elm.Surface || {};
   if (_elm.Surface.values)
   return _elm.Surface.values;
   var _N = Elm.Native,
   _U = _N.Utils.make(_elm),
   _L = _N.List.make(_elm),
   _E = _N.Error.make(_elm),
   _J = _N.JavaScript.make(_elm),
   $moduleName = "Surface";
   var Basics = Elm.Basics.make(_elm);
   var Color = Elm.Color.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Collage = Elm.Graphics.Collage.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Element = Elm.Graphics.Element.make(_elm);
   var List = Elm.List.make(_elm);
   var Maybe = Elm.Maybe.make(_elm);
   var Native = Native || {};
   Native.Ports = Elm.Native.Ports.make(_elm);
   var Signal = Elm.Signal.make(_elm);
   var String = Elm.String.make(_elm);
   var Term = Elm.Term.make(_elm);
   var Text = Elm.Text.make(_elm);
   var Time = Elm.Time.make(_elm);
   var _op = {};
   var listToApp = function (l) {
      return function () {
         var lToA = F2(function (x,
         xs) {
            return function () {
               switch (xs.ctor)
               {case "::": return A2(lToA,
                    A2(Term.App,x,xs._0),
                    xs._1);
                  case "[]": return x;}
               _E.Case($moduleName,
               "between lines 68 and 71");
            }();
         });
         return function () {
            switch (l.ctor)
            {case "::":
               return Maybe.Just(A2(lToA,
                 l._0,
                 l._1));
               case "[]":
               return Maybe.Nothing;}
            _E.Case($moduleName,
            "between lines 71 and 73");
         }();
      }();
   };
   var termstr = function (x) {
      return function () {
         switch (x.ctor)
         {case "App": switch (x._0.ctor)
              {case "Lam":
                 return List.concat(_J.toList([pstring(A2(Term.Lam,
                                              x._0._0,
                                              x._0._1))
                                              ," "
                                              ,argstring(x._1)]));}
              return List.concat(_J.toList([termstr(x._0)
                                           ," "
                                           ,argstring(x._1)]));
            case "Define":
            return List.concat(_J.toList([x._0
                                         ," ≝ "
                                         ,termstr(x._1)]));
            case "Lam":
            return List.concat(_J.toList(["λ"
                                         ,x._0
                                         ,"."
                                         ,termstr(x._1)
                                         ,""]));
            case "Undefine":
            return List.concat(_J.toList([x._0
                                         ," ≝ :("]));
            case "Var": return x._0;}
         _E.Case($moduleName,
         "between lines 26 and 32");
      }();
   };
   var argstring = function (a) {
      return function () {
         switch (a.ctor)
         {case "Var": return a._0;}
         return pstring(a);
      }();
   };
   var pstring = function (t) {
      return List.concat(_J.toList(["("
                                   ,termstr(t)
                                   ,")"]));
   };
   var white = function (c) {
      return _U.eq(c,
      _U.chr(" ")) || (_U.eq(c,
      _U.chr("\t")) || _U.eq(c,
      _U.chr("\n")));
   };
   var trim = function (s) {
      return function () {
         var _v19 = String.uncons(s);
         switch (_v19.ctor)
         {case "Just":
            switch (_v19._0.ctor)
              {case "_Tuple2":
                 return white(_v19._0._0) ? trim(_v19._0._1) : s;}
              break;
            case "Nothing": return "";}
         _E.Case($moduleName,
         "between lines 20 and 23");
      }();
   };
   var defStr = function (s) {
      return _U.eq(s,
      "≝") || _U.eq(s,":=");
   };
   var lam = function (c) {
      return _U.eq(c,
      _U.chr("\\")) || _U.eq(c,
      function () {
         var _v23 = String.uncons("λ");
         switch (_v23.ctor)
         {case "Just":
            switch (_v23._0.ctor)
              {case "_Tuple2":
                 return _v23._0._0;}
              break;}
         _E.Case($moduleName,
         "on line 12, column 28 to 71");
      }());
   };
   var seperator = function (c) {
      return lam(c) || (defStr(A2(String.cons,
      c,
      "")) || (_U.eq(c,
      _U.chr(".")) || (_U.eq(c,
      _U.chr("(")) || (_U.eq(c,
      _U.chr(")")) || white(c)))));
   };
   var readWord0 = F2(function (c,
   s) {
      return function () {
         var readW = F3(function (c,
         s,
         n) {
            return seperator(c) ? n - 1 : function () {
               var _v27 = String.uncons(s);
               switch (_v27.ctor)
               {case "Just":
                  switch (_v27._0.ctor)
                    {case "_Tuple2":
                       return A3(readW,
                         _v27._0._0,
                         _v27._0._1,
                         n + 1);}
                    break;
                  case "Nothing": return n;}
               _E.Case($moduleName,
               "between lines 116 and 118");
            }();
         });
         var n = A3(readW,c,s,0);
         return {ctor: "_Tuple2"
                ,_0: A2(String.left,n,s)
                ,_1: A2(String.dropLeft,n,s)};
      }();
   });
   var readWord = function (s) {
      return function () {
         var trims = trim(s);
         return function () {
            var _v31 = String.uncons(trims);
            switch (_v31.ctor)
            {case "Just":
               switch (_v31._0.ctor)
                 {case "_Tuple2":
                    return seperator(_v31._0._0) ? Maybe.Nothing : Maybe.Just(A2(readWord0,
                      _v31._0._0,
                      trims));}
                 break;
               case "Nothing":
               return Maybe.Nothing;}
            _E.Case($moduleName,
            "between lines 110 and 113");
         }();
      }();
   };
   var bnd = F2(function (f,m) {
      return function () {
         switch (m.ctor)
         {case "Just": return f(m._0);
            case "Nothing":
            return Maybe.Nothing;}
         _E.Case($moduleName,
         "between lines 5 and 7");
      }();
   });
   var fmap = F2(function (f,m) {
      return A2(bnd,
      function (x) {
         return Maybe.Just(f(x));
      },
      m);
   });
   var readParam = function (s) {
      return A2(bnd,
      function (_v37) {
         return function () {
            switch (_v37.ctor)
            {case "_Tuple2":
               return function () {
                    var _v41 = String.uncons(_v37._1);
                    switch (_v41.ctor)
                    {case "Just":
                       switch (_v41._0.ctor)
                         {case "_Tuple2":
                            switch (_v41._0._0 + "")
                              {case ".":
                                 return Maybe.Just({ctor: "_Tuple2"
                                                   ,_0: _v37._0
                                                   ,_1: _v41._0._1});}
                              break;}
                         break;}
                    return Maybe.Nothing;
                 }();}
            _E.Case($moduleName,
            "between lines 93 and 95");
         }();
      },
      readWord(s));
   };
   var readParen = function (str) {
      return function () {
         var count = F3(function (s,
         n,
         l) {
            return A2(bnd,
            function (_v45) {
               return function () {
                  switch (_v45.ctor)
                  {case "_Tuple2":
                     return _U.eq(_v45._0,
                       _U.chr(")")) && _U.eq(l,
                       0) ? Maybe.Just(n) : _U.eq(_v45._0,
                       _U.chr(")")) ? A3(count,
                       _v45._1,
                       n + 1,
                       l - 1) : _U.eq(_v45._0,
                       _U.chr("(")) ? A3(count,
                       _v45._1,
                       n + 1,
                       l + 1) : A3(count,
                       _v45._1,
                       n + 1,
                       l);}
                  _E.Case($moduleName,
                  "between lines 99 and 102");
               }();
            },
            String.uncons(s));
         });
         var res = A2(fmap,
         function (n) {
            return {ctor: "_Tuple2"
                   ,_0: A2(String.left,n,str)
                   ,_1: A2(String.dropLeft,
                   n + 1,
                   str)};
         },
         A3(count,str,0,0));
         return A2(bnd,
         function (_v49) {
            return function () {
               switch (_v49.ctor)
               {case "_Tuple2": return A2(fmap,
                    function (t) {
                       return {ctor: "_Tuple2"
                              ,_0: t
                              ,_1: _v49._1};
                    },
                    read(_v49._0));}
               _E.Case($moduleName,
               "on line 106, column 27 to 57");
            }();
         },
         res);
      }();
   };
   var read = function (s) {
      return A2(bnd,
      listToApp,
      readList(trim(s)));
   };
   var readList = function (s) {
      return function () {
         var readL = function (_v53) {
            return function () {
               switch (_v53.ctor)
               {case "_Tuple2":
                  return lam(_v53._0) ? A2(fmap,
                    function (t) {
                       return _J.toList([t]);
                    },
                    readLam(_v53._1)) : _U.eq(_v53._0,
                    _U.chr("(")) ? A2(bnd,
                    function (_v57) {
                       return function () {
                          switch (_v57.ctor)
                          {case "_Tuple2": return A2(fmap,
                               function (ts) {
                                  return {ctor: "::"
                                         ,_0: _v57._0
                                         ,_1: ts};
                               },
                               readList(_v57._1));}
                          _E.Case($moduleName,
                          "on line 77, column 60 to 93");
                       }();
                    },
                    readParen(_v53._1)) : seperator(_v53._0) ? Maybe.Nothing : readVar(A2(readWord0,
                    _v53._0,
                    A2(String.cons,
                    _v53._0,
                    _v53._1)));}
               _E.Case($moduleName,
               "between lines 76 and 80");
            }();
         };
         return function () {
            var _v61 = String.uncons(trim(s));
            switch (_v61.ctor)
            {case "Just":
               return readL(_v61._0);
               case "Nothing":
               return Maybe.Just(_J.toList([]));}
            _E.Case($moduleName,
            "between lines 81 and 83");
         }();
      }();
   };
   var readLam = function (s) {
      return A2(bnd,
      function (_v63) {
         return function () {
            switch (_v63.ctor)
            {case "_Tuple2": return A2(fmap,
                 function (b) {
                    return A2(Term.Lam,
                    _v63._0,
                    b);
                 },
                 read(_v63._1));}
            _E.Case($moduleName,
            "between lines 88 and 89");
         }();
      },
      readParam(s));
   };
   var readVar = function (_v67) {
      return function () {
         switch (_v67.ctor)
         {case "_Tuple2":
            return defStr(_v67._0) ? Maybe.Nothing : A2(fmap,
              function (ts) {
                 return {ctor: "::"
                        ,_0: Term.Var(_v67._0)
                        ,_1: ts};
              },
              readList(_v67._1));}
         _E.Case($moduleName,
         "between lines 85 and 86");
      }();
   };
   var readTerm = function (s) {
      return function () {
         var def = F2(function (a,r) {
            return function () {
               var _v71 = read(r);
               switch (_v71.ctor)
               {case "Just":
                  return Maybe.Just(A2(Term.Define,
                    a,
                    _v71._0));
                  case "Nothing":
                  return Maybe.Nothing;}
               _E.Case($moduleName,
               "between lines 55 and 58");
            }();
         });
         var undefStr = function (s) {
            return A2(String.startsWith,
            ":(",
            s) && _U.eq(trim(A2(String.dropLeft,
            2,
            s)),
            "");
         };
         var defUndef0 = F2(function (a,
         r) {
            return undefStr(r) ? Maybe.Just(Term.Undefine(a)) : A2(def,
            a,
            r);
         });
         var ws = function () {
            var _v73 = readWord(s);
            switch (_v73.ctor)
            {case "Just":
               switch (_v73._0.ctor)
                 {case "_Tuple2":
                    return function () {
                         var _v77 = readWord(_v73._0._1);
                         switch (_v77.ctor)
                         {case "Just":
                            switch (_v77._0.ctor)
                              {case "_Tuple2":
                                 return defStr(_v77._0._0) ? Maybe.Just({ctor: "_Tuple2"
                                                                        ,_0: _v73._0._0
                                                                        ,_1: _v77._0._1}) : Maybe.Nothing;}
                              break;
                            case "Nothing":
                            return Maybe.Nothing;}
                         _E.Case($moduleName,
                         "between lines 42 and 45");
                      }();}
                 break;
               case "Nothing":
               return Maybe.Nothing;}
            _E.Case($moduleName,
            "between lines 41 and 47");
         }();
         var defUndef = function () {
            switch (ws.ctor)
            {case "Just":
               switch (ws._0.ctor)
                 {case "_Tuple2":
                    return function () {
                         var _v85 = trim(ws._0._1);
                         switch (_v85)
                         {case "":
                            return Maybe.Just(Term.Undefine(ws._0._0));}
                         return A2(defUndef0,
                         ws._0._0,
                         _v85);
                      }();}
                 break;
               case "Nothing":
               return Maybe.Nothing;}
            _E.Case($moduleName,
            "between lines 47 and 52");
         }();
         return function () {
            switch (defUndef.ctor)
            {case "Just":
               return Maybe.Just(defUndef._0);
               case "Nothing": return read(s);}
            _E.Case($moduleName,
            "between lines 58 and 60");
         }();
      }();
   };
   _elm.Surface.values = {_op: _op
                         ,bnd: bnd
                         ,fmap: fmap
                         ,lam: lam
                         ,defStr: defStr
                         ,seperator: seperator
                         ,white: white
                         ,trim: trim
                         ,termstr: termstr
                         ,argstring: argstring
                         ,pstring: pstring
                         ,readTerm: readTerm
                         ,read: read
                         ,listToApp: listToApp
                         ,readList: readList
                         ,readVar: readVar
                         ,readLam: readLam
                         ,readParam: readParam
                         ,readParen: readParen
                         ,readWord: readWord
                         ,readWord0: readWord0};
   return _elm.Surface.values;
};Elm.Term = Elm.Term || {};
Elm.Term.make = function (_elm) {
   "use strict";
   _elm.Term = _elm.Term || {};
   if (_elm.Term.values)
   return _elm.Term.values;
   var _N = Elm.Native,
   _U = _N.Utils.make(_elm),
   _L = _N.List.make(_elm),
   _E = _N.Error.make(_elm),
   _J = _N.JavaScript.make(_elm),
   $moduleName = "Term";
   var Basics = Elm.Basics.make(_elm);
   var Color = Elm.Color.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Collage = Elm.Graphics.Collage.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Element = Elm.Graphics.Element.make(_elm);
   var List = Elm.List.make(_elm);
   var Maybe = Elm.Maybe.make(_elm);
   var Native = Native || {};
   Native.Ports = Elm.Native.Ports.make(_elm);
   var Signal = Elm.Signal.make(_elm);
   var String = Elm.String.make(_elm);
   var Text = Elm.Text.make(_elm);
   var Time = Elm.Time.make(_elm);
   var _op = {};
   var Undefine = function (a) {
      return {ctor: "Undefine"
             ,_0: a};
   };
   var Define = F2(function (a,b) {
      return {ctor: "Define"
             ,_0: a
             ,_1: b};
   });
   var Var = function (a) {
      return {ctor: "Var",_0: a};
   };
   var App = F2(function (a,b) {
      return {ctor: "App"
             ,_0: a
             ,_1: b};
   });
   var Lam = F2(function (a,b) {
      return {ctor: "Lam"
             ,_0: a
             ,_1: b};
   });
   _elm.Term.values = {_op: _op
                      ,Lam: Lam
                      ,App: App
                      ,Var: Var
                      ,Define: Define
                      ,Undefine: Undefine};
   return _elm.Term.values;
};</script></head><body><script type="text/javascript">Elm.fullscreen(Elm.Main)</script><noscript></noscript></body></html>